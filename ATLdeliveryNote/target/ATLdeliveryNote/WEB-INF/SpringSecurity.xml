<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:context="http://www.springframework.org/schema/context"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="
                http://www.springframework.org/schema/security 
                http://www.springframework.org/schema/security/spring-security-4.2.xsd
                http://www.springframework.org/schema/beans 
                http://www.springframework.org/schema/beans/spring-beans.xsd
                http://www.springframework.org/schema/context 
                http://www.springframework.org/schema/context/spring-context.xsd">
                
         <context:component-scan base-package="project.ATLdeliveryNote.controller" />
 
	<http auto-config="true"  use-expressions="true">
		<intercept-url pattern="/resources/**" access="permitAll"/>
		<intercept-url pattern="/index.html" access="permitAll"/>
		<intercept-url pattern="/style.css" access="permitAll"/>
		<intercept-url pattern="/login.js" access="permitAll"/>
		<intercept-url pattern="/images/**" access="permitAll"/>
		<intercept-url pattern="/products/add**" access="hasAuthority('ROLE_USER')" />
		<intercept-url pattern="/products/update**" access="hasAuthority('ROLE_USER')" />
		<intercept-url pattern="/delivery/add**" access="hasAuthority('ROLE_USER')" />
		<intercept-url pattern="/delivery/update**" access="hasAuthority('ROLE_USER')" />
		<intercept-url pattern="/delivery/delete**" access="hasAuthority('ROLE_USER')" />
		<intercept-url pattern="/" access="permitAll"/>
		<intercept-url pattern="/products/login" access="permitAll"/>
		<intercept-url pattern="/" access="permitAll"/>
		<intercept-url pattern="/ATLdeliveryNote/**" access="permitAll"/>
		<intercept-url pattern="/**" access="hasAuthority('ROLE_USER')" />
		
 
		<form-login 
		    login-page="/index.html"
		    login-processing-url="/j_spring_security_check"
		    default-target-url="/products/gets"
			authentication-failure-url="/index.html?error"
			username-parameter="username"
			password-parameter="password" />
		<logout logout-success-url="/login?logout"  />
		<!-- enable csrf protection -->
		<!--<csrf/> -->
		
		<csrf disabled="true"/>
		<http-basic />
	</http>
 
	 <authentication-manager>
        <authentication-provider>
            <jdbc-user-service data-source-ref="dataSource"
                users-by-username-query="SELECT username, password, enables FROM users WHERE username = ?"
                authorities-by-username-query="SELECT username, authority FROM authorities WHERE username = ?" />
        </authentication-provider>
    </authentication-manager>
 
</beans:beans>